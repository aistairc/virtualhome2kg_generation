# オブジェクトリストおよび動作リストの CSV から JSON への変換

## 使い方

- デプロイ時はビルド処理の前に変換スクリプトが実行される設定になっているため、CSV ファイルを更新して main ブランチに push すれば自動で反映される。
- 手動で実行したい場合は以下のコマンドを叩く。

  - オブジェクトリストの変換
    - `npm run convert:objects`
  - 動作リストの変換
    - `npm run convert:actions`

- 変換後の JSON ファイルは `src/data/` に配置されている。

## 形式

### 動作リスト

- 変換元のファイルは `/scripts/actions/actions.csv`
  - 動作リストに変更を加えたい場合はこのファイルを直接編集する。
- データは 6 列
  - サポート状況
  - Action
  - オブジェクトの数
  - RDF
  - 条件（プロパティ）
  - 条件（ステート）
- `サポート状況` は、オリジナルに含まれていたので残してあるが、変換には使われていない。
- `Action` は、動作の名称。
- `オブジェクトの数` は、動画スクリプトを記述する際に求められるオブジェクトの数。
  - `0`, `1`, `2` のいずれか。半角しか受け付けないので注意。
- `RDF` は、RDF データで割り当てられている URI の末尾。
- `条件（プロパティ）` は、指定するオブジェクトが持っているべきプロパティの条件。
  - プロパティ名（ `LOOKABLE`等 ）を指定する。
  - 複数指定する場合は `&` 区切りで繋げる。
    - `&` の前後にスペースが含まれていても良い。
    - たとえば `LOOKABLE & GRABBABLE` 等。
    - 全角の `＆` では区切り記号として認識しないので注意。
- `条件（ステート）` は、指定するオブジェクトが満たしているべき状態の条件。
  - 状態名（ `OPEN`等 ）を指定する。
  - ただし、スクリプト作成支援ツール側では、動作からオブジェクトを絞り込む際に、ステート条件は使っていない（状態はそれまでの動作などによって変化するため）。

### オブジェクトリスト

- 変換元のファイルは `/scripts/objects/scene(1|2|3|4|5|6|7).csv`
  - ファイルの名のシーンに対応したオブジェクトを記述する。
  - オブジェクトリストに変更を加えたい場合はこのファイルを直接編集する。
- データの列数は可変。
  - nodes/id
  - nodes/class_name
  - nodes/properties/{i}
  - nodes/states/{i}
- ヘッダーの文字列を見て変換しているため、列の順序は入れ替え可能。
- nodes/properties/{i} と nodes/states/{i} は必要に応じて増減可能。
- `nodes/id` は、オブジェクトの ID。シーン内で一意な番号。
- `nodes/class_name` は、オブジェクトのクラス名。どのようなオブジェクトなのかを表す。
  - たとえば `book` など。
- `nodes/properties/{i}` は、オブジェクトが持っているプロパティ。
  - 動作の対象にできるかどうかを判断するのに使われる。
  - たとえば `GRABBABLE` を持っているオブジェクトは `GRAB` の対象にできる。
- `nodes/states/{i}` は、オブジェクトの状態。
  - スクリプト作成支援ツール側では特に使われていない。
